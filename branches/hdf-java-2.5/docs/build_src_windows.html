<?php
include ("../links.php"); 
include ("../includes/header.html"); 
?>

<fieldset><h1>Compiling HDF-JAVA Source on Windows</h1></fieldset>

<p>
<h2>
Source Files</h2>

After you download and extract the source package, you will have the HDF Java
native C code and the Java source code for JNI, HDF-Object package and HDFView.
You need to compile the C source and Java source separately. The following
instructions tell you how to build the C source in Visual C++ and the Java
source from batch file.

<p>
<table WIDTH=100% BORDER COLS=2>
<caption><b>HDF Java Product Source</b></caption>
<tr>
<th> Source directory</th>
<th> Description</th>
</tr>

<tr>
<td> hdf-java/native/hdflib/</td>
<td> C header files and C source files for HDF4 Java Native Interface</td>
</tr>

<tr>
<td> hdf-java/native/hdf5lib/</td>
<td> C header files and C source files for HDF5 Java Native Interface</td>
</tr>

<tr>
<td> hdf-java/ncsa/hdf/hdflib/</td>
<td> Java source files for HDF4 Java Native Interface</td>
</tr>

<tr>
<td> hdf-java/ncsa/hdf/hdf5lib/</td>
<td> Java source files for HDF5 Java Native Interface</td>
</tr>

<tr>
<td> hdf-java/ncsa/hdf/object/</td>
<td> Java source files for HDF-Object package</td>
</tr>

<tr>
<td> hdf-java/ncsa/hdf/view/</td>
<td> Java source files for HDFView</td>
</tr>

</table>
<hr>
<h3>
Requirements</h3>
You need the following libraries in order to compile the HDF Java products.
<UL>
  <LI>The Pre-Compiled HDF4 Binaries: obtain from
    <a href="/release4/obtain.html">/release4/obtain.html</a>
  <LI>The Pre-Compiled HDF5 Binaries: obtain from
    <a href="/HDF5/release/obtain5.html">/HDF5/release/obtain5.html</a>
    <LI> JPEG Library: obtain from
    <a href="ftp://ftp.hdfgroup.org/lib-external/jpeg/">ftp://ftp.hdfgroup.org/lib-external/jpeg/</a>
    <LI> GZIP Library: obtain from
    <a href="ftp://ftp.hdfgroup.org/lib-external/zlib/">ftp://ftp.hdfgroup.org/lib-external/zlib/</a>
    <LI> SZIP Library: obtain from
    <a href="ftp://ftp.hdfgroup.org/lib-external/szip/">ftp://ftp.hdfgroup.org/lib-external/szip/</a>
    <LI> JDK 1.5.0 or above
</UL>
<hr>
<h3>
Compile the HDF Java Native C</h3>
To compile the HDF Java Native C code, you need to have <b>Microsoft Visual C++</b>
installed on your machine. Two Windows Makefiles hdf-java/windows are provided
to help you to build the C source code.
<DL>
  <DT><a href="jhdf.mak.txt">jhdf.mak</a>
    <DD>Makefile to compile HDF4 Java Native C, native/hdflib/*.c files<br>
    <b>Winsock functions, Ws2_32.lib, must be included, i.e. LINK32_FLAGS=... ws2_32.lib ...</b></DD></DT>
  <DT><a href="jhdf5.mak.txt">jhdf5.mak</a>
    <DD>Makefile to compile HDF5 Java Native C, native/hdf5lib/*.c files</DD></DT>
</DL>

You will need the nmake tool to run the makfile. The nmake tool come with Microsoft
Visual C++. The first step is to configure the makfile. Edit the nt_makefile to set
the dependent libraries and other requirements.

<hr>
<h3>
Compile the HDF Java Source Code</h3>
To compile the HDF Java Source Code, you need to have jdk1.5.0 or above
installed on your machine. A batch file under hdf-java/windows is provided to
help you to build the Java source code.
<DL>
  <DT><a href="Makefile_java.bat.txt">Makefile_java.bat</a>
    <DD>Batch to compile HDF Java source</DD></DT>
</DL>

You will need to configure the batch file before you run it. Edit the batch file
to set the dependent libraries and other requirements.

<p>
<table cellpadding="4" cellspacing="2" border="1"  align="center">
<tr>
<td>
        @ECHO OFF<br>
        <br>
        @REM =======================================================================<br>
        @REM<br>
        @REM          Batch file to compile the HDF Java source code<br>
        @REM<br>
        @REM =======================================================================<br>
        <br>
        @REM set up your java home directory(requires jdk1.5.0 or above), for example<br>
        @REM SET JAVAHOME=d:\java\jdk1.5.0<br>
        SET JAVAHOME=<br>
        <br>
        @REM set up "HDF JAVA Product" home directory, for example<br>
        @REM SET HDFJAVA=D:\work\hdf-java<br>
        SET HDFJAVA=<br></td>
</tr>
</table>
<hr>
<h3>
Running the HDF Java code</h3>
After successfully run the makefile and batch file, the binaries of the HDF Java
products are packed and put at $(JAVAHOME)\lib.

<p>
<table BORDER COLS=2 >

<tr>
<th width=25% BGCOLOR="#CCDFF">Binary file</th>

<th width=75% BGCOLOR="#CCDDFF" colspan="2">Description</th>
</tr>

<tr>
<td>lib/jhdf.jar</td>

<td colspan="2">The Java HDF Interface, accesses the native HDF4 library</td>
</tr>

<tr>
<td>lib/jhdf5.jar</td>

<td colspan="2">The Java HDF5 Interface, accesses the native HDF5 library</td>
</tr>

<tr>
<td>lib/jhdfobj.jar</td>

<td colspan="2">The common HDF object package, ncsa.hdf.object</td>
</tr>

<tr>
<td>lib/jhdf4obj.jar</td>

<td colspan="2">The HDF4 object package, ncsa.hdf.object.h4</td>
</tr>

<tr>
<td>lib/jhdf5obj.jar</td>

<td colspan="2">The HDF5 object package, ncsa.hdf.object.h5</td>
</tr>

<tr>
<td>lib/jhdfview.jar</td>

<td colspan="2">The ncsa.hdf.view package, for HDFView only.</td>
</tr>

<tr>
<td>&nbsp;</td>
<td colspan="2" >lib/win/</td>
</tr>
<tr>
<td> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jhdf.dll</td>

<td colspan="2">The native HDF4 library and JNI implementation (called by jhdf.jar)</td>
</tr>

<tr>
<td> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jhdf5.dll</td>

<td colspan="2">The native HDF5 library and JNI implementation (called by jhdf5.jar)</td>

</tr>
</table>

<p>
Set the following batch file to run the HDFView
<p>
<code>
        @ECHO OFF<br>
        <br>
        @REM =======================================================================<br>
        @REM<br>
        @REM          Batch file to run the HDFView<br>
        @REM<br>
        @REM =======================================================================<br>
        <br>
        @REM set up your java home directory(requires jdk1.5.0 or above), for example<br>
        @REM SET JAVAHOME=d:\java\jdk1.5.0<br>
        SET JAVAHOME=<br>
        <br>
        @REM set up "HDF JAVA Product" home directory, for example<br>
        @REM SET HDFJAVA=D:\work\hdf-java<br>
        SET HDFJAVA=<br>
        <br>
        <br>
        @REM Do not make changes under this line unless you know what you are doing.<br>
        @REM =======================================================================<br>
        <br>
        SET PATH=%HDFJAVA%\lib\win;%PATH%<br>
        <br>
        @REM set the JNI classpath<br>
        set JNI_CLASSPATH=%HDFJAVA%/lib/jhdf.jar;%HDFJAVA%/lib/jhdf5.jar<br>
        <br>
        @REM set the object package classpath<br>
        set OBJ_CLASSPATH=%HDFJAVA%/lib/jhdfobj.jar;%HDFJAVA%/lib/jhdf4obj.jar;<br>
	(continued)%HDFJAVA%/lib/jhdf5obj.jar;%HDFJAVA%\lib\netcdf.jar;%HDFJAVA%\lib\fits.jar<br>
        <br>
        @REM set the CLASSPATH<br>
        set CLASSPATH=%JNI_CLASSPATH%;%OBJ_CLASSPATH%;%HDFJAVA%/lib/jhdfview.jar<br>
        <br>
        %JAVAHOME%\bin\java -mx999m -classpath %CLASSPATH% ncsa.hdf.view.HDFView -root %HDFJAVA%<br>
        pause<br>
        :END<br>
</code>
<?php 
include ("../includes/footer.html"); 
?>

